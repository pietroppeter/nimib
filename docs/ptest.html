<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>ptest.nim</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>üê≥</text></svg>">
  <meta content="text/html; charset=utf-8" http-equiv="content-type">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <link rel='stylesheet' href='https://unpkg.com/normalize.css/'>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
  <link rel='stylesheet' href='https://cdn.jsdelivr.net/gh/pietroppeter/nimib/assets/atom-one-light.css'>
  <style>
.nb-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.nb-small {
  font-size: 0.8rem;
}
button.nb-small {
  float: right;
  padding: 2px;
  padding-right: 5px;
  padding-left: 5px;
}
section#source {
  display:none
}
</style>
  
  <script async defer data-domain="pietroppeter.github.io/nimib" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
<header>
<div class="nb-box">
  <span><a href=".">üè°</a></span>
  <span><code>ptest.nim</code></span>
  <span><a href="https://github.com/pietroppeter/nimib"><svg aria-hidden="true" width="1.2em" height="1.2em" style="vertical-align: middle;" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59c.4.07.55-.17.55-.38c0-.19-.01-.82-.01-1.49c-2.01.37-2.53-.49-2.69-.94c-.09-.23-.48-.94-.82-1.13c-.28-.15-.68-.52-.01-.53c.63-.01 1.08.58 1.23.82c.72 1.21 1.87.87 2.33.66c.07-.52.28-.87.51-1.07c-1.78-.2-3.64-.89-3.64-3.95c0-.87.31-1.59.82-2.15c-.08-.2-.36-1.02.08-2.12c0 0 .67-.21 2.2.82c.64-.18 1.32-.27 2-.27c.68 0 1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82c.44 1.1.16 1.92.08 2.12c.51.56.82 1.27.82 2.15c0 3.07-1.87 3.75-3.65 3.95c.29.25.54.73.54 1.48c0 1.07-.01 1.93-.01 2.2c0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z" fill="#000"></path></svg></a></span>
</div>
<hr>
</header><main>
<h1>Print-testing for nimib</h1>
<p>What is print-testing? Testing by comparing printed output of a file with a versioned reference (see <a href="https://github.com/treeform/ptest">treeform/ptest</a>).</p>
<h2>Test Results ‚ùå</h2>
<table>
<thead>
<tr>
<th><span style="color:blue">skip</span></th>
<th><span style="color:red">fail</span></th>
<th><span style="color:green">pass</span></th>
<th>total</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>5</td>
<td>4</td>
<td>9</td>
</tr></tbody></table>
<pre><samp>&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;cheatsheet.html&quot;&gt;cheatsheet.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;hello.html&quot;&gt;hello.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/hello.html b/C:/Users/ppeterlongo/nimib/docs/hello.tmp.html
index 07d2606..482a6df 100644
--- a/C:/Users/ppeterlongo/nimib/docs/hello.html
+++ b/C:/Users/ppeterlongo/nimib/docs/hello.tmp.html
@@ -45,8 +45,7 @@ and incidentally you might learn the basics of &lt;a href=&quot;https://github.com/pietr
 &lt;h3&gt;A secret message&lt;/h3&gt;
 &lt;p&gt;Inside this document is hidden a secret message. I will ask the computer to spit it out:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; secret&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;[104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;[104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;what does this integer sequence mean?
 Am I supposed to &lt;a href=&quot;https://oeis.org/search?q=104%2C+101%2C+108%2C+108%2C+111%2C+44%2C+32%2C+119%2C+111%2C+114%2C+108%2C+100&amp;language=english&amp;go=Search&quot;&gt;recognize it&lt;/a&gt;?&lt;/p&gt;
 &lt;h3&gt;A cryptoanalytic weapon&lt;/h3&gt;
@@ -61,8 +60,7 @@ a recently declassified top-secret cryptoanalytic weapon:&lt;/p&gt;
 finally decrypt what the computer wants to tell me:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; msg = decode secret
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; msg&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;hello, world
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;hello, world&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;&lt;em&gt;Hey&lt;/em&gt;, there must be a bug somewhere, the message (&lt;code&gt;hello, world&lt;/code&gt;) is not even addressed to me!&lt;/p&gt;
 
 &lt;/main&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/hello.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/hello.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;index.html&quot;&gt;index.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;mostaccio.html&quot;&gt;mostaccio.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/mostaccio.html b/C:/Users/ppeterlongo/nimib/docs/mostaccio.tmp.html
index ac7f4bd..1563169 100644
--- a/C:/Users/ppeterlongo/nimib/docs/mostaccio.html
+++ b/C:/Users/ppeterlongo/nimib/docs/mostaccio.tmp.html
@@ -72,9 +72,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;in_california&amp;quot;&lt;/span&gt;] = &lt;span clas
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;Hello Chris
 You have just won 10000 dollars!
-Well, 6000.0 dollars, after taxes.
-
-&lt;/samp&gt;&lt;/pre&gt;
+Well, 6000.0 dollars, after taxes.&lt;/samp&gt;&lt;/pre&gt;
 &lt;h2&gt;DESCRIPTION&lt;/h2&gt;
 &lt;p&gt;Mustache can be used for HTML, config files, source code - anything.
 It works by expanding tags in a template using values provided in a context
@@ -119,8 +117,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;company&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hlj
 * 
 * &amp;amp;lt;b&amp;amp;gt;Github&amp;amp;lt;/b&amp;amp;gt;
 * &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;
-* &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+* &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;added the &lt;code&gt;{{&amp;amp;company}}&lt;/code&gt; to clarify that it is just an alternative syntax with the same result
 as the triple mustache.&lt;/p&gt;
@@ -142,9 +139,7 @@ That is, &lt;code&gt;{{#person}}&lt;/code&gt; begins a &amp;quot;person&amp;quot; section while &lt;cod
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;person&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;Shown.
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;Shown.&lt;/samp&gt;&lt;/pre&gt;
 &lt;h4&gt;Non-Empty Lists&lt;/h4&gt;
 &lt;p&gt;If the &lt;strong&gt;person&lt;/strong&gt; key exists and has a non-false value,
 the HTML between the pound and slash will be rendered and displayed one or more times.&lt;/p&gt;
@@ -162,11 +157,9 @@ context = newContext()
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;repo&amp;quot;&lt;/span&gt;] = %*[{&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;resque&amp;quot;&lt;/span&gt;}, {&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;hub&amp;quot;&lt;/span&gt;}, {&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;rip&amp;quot;&lt;/span&gt;}]&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  &amp;lt;b&amp;gt;resque&amp;lt;/b&amp;gt;
+&lt;pre&gt;&lt;samp&gt;&amp;lt;b&amp;gt;resque&amp;lt;/b&amp;gt;
   &amp;lt;b&amp;gt;hub&amp;lt;/b&amp;gt;
-  &amp;lt;b&amp;gt;rip&amp;lt;/b&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;b&amp;gt;rip&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;output is not the expected output:&lt;/p&gt;
 &lt;/blockquote&gt;
@@ -190,8 +183,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;wrapped&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hlj
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;&amp;lt;b&amp;gt;  Willy is awesome.
-&amp;lt;/b&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;output is not the expected output:&lt;/p&gt;
 &lt;/blockquote&gt;
@@ -209,9 +201,7 @@ it will be used as the context for a single rendering of the block.&lt;/p&gt;
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;person?&amp;quot;&lt;/span&gt;] = %*{&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;Jon&amp;quot;&lt;/span&gt;}&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  Hi Jon!
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;Hi Jon!&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Inverted Sections&lt;/h3&gt;
 &lt;p&gt;An inverted section begins with a caret (hat) and ends with a slash.
 That is &lt;code&gt;{{^person}}&lt;/code&gt; begins a &amp;quot;person&amp;quot; inverted section while &lt;code&gt;{{/person}}&lt;/code&gt; ends it.&lt;/p&gt;
@@ -231,16 +221,13 @@ That is, they will be rendered if the key doesn't exist, is false, or is an empt
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;repo&amp;quot;&lt;/span&gt;] = empty&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  No repos :(
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;No repos :(&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Comments&lt;/h3&gt;
 &lt;p&gt;Comments begin with a bang and are ignored. The following template:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;tmpl = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&amp;lt;h1&amp;gt;Today{{! ignore me }}.&amp;lt;/h1&amp;gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Will render as follows:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(newContext())&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;&amp;lt;h1&amp;gt;Today.&amp;lt;/h1&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;&amp;lt;h1&amp;gt;Today.&amp;lt;/h1&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Partials&lt;/h3&gt;
 &lt;p&gt;Partials begin with a greater than sign, like &lt;code&gt;{{&amp;gt; box}}&lt;/code&gt;.&lt;/p&gt;
 &lt;p&gt;Partials are rendered at runtime (as opposed to compile time),
@@ -288,16 +275,12 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;names&amp;quot;&lt;/span&gt;] = %*[{&lt;span class=&quot;h
 &lt;pre&gt;&lt;samp&gt;&amp;lt;h2&amp;gt;Names&amp;lt;/h2&amp;gt;
   &amp;lt;strong&amp;gt;resque&amp;lt;/strong&amp;gt;
   &amp;lt;strong&amp;gt;hub&amp;lt;/strong&amp;gt;
-  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;{{&amp;gt;expanded}}&amp;quot;&lt;/span&gt;.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;&amp;lt;h2&amp;gt;Names&amp;lt;/h2&amp;gt;
   &amp;lt;strong&amp;gt;resque&amp;lt;/strong&amp;gt;
   &amp;lt;strong&amp;gt;hub&amp;lt;/strong&amp;gt;
-  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Set Delimiter&lt;/h3&gt;
 &lt;p&gt;Set Delimiter tags start with an equal sign and change the tag delimiters from {{ and }} to custom strings.&lt;/p&gt;
 &lt;p&gt;Consider the following contrived example:&lt;/p&gt;
@@ -321,9 +304,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;default_tags_again&amp;quot;&lt;/span&gt;] = &lt;span
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;* one
 * two
-* three
-
-&lt;/samp&gt;&lt;/pre&gt;
+* three&lt;/samp&gt;&lt;/pre&gt;
 
 &lt;/main&gt;
 &lt;footer&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/mostaccio.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;nolan.html&quot;&gt;nolan.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;numerical.html&quot;&gt;numerical.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/numerical.html b/C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html
index 861584f..76e5950 100644
--- a/C:/Users/ppeterlongo/nimib/docs/numerical.html
+++ b/C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html
@@ -85,13 +85,11 @@ to integrate an ODE.&lt;/p&gt;
 &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; y5 = y(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;)
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;y(5): &amp;quot;&lt;/span&gt;, y5&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;y'(0): 5.0
-y(5): -1.612374396254655
-&lt;/samp&gt;&lt;/pre&gt;
+y(5): -1.612374396254655&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;We want the solution to be available for every point in $[0, 5]$ with timestep $h=0.05$&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; tspan = arange(&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5.0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0.05&lt;/span&gt;, includeEnd = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tspan[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; .. &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;], &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot; . . . &amp;quot;&lt;/span&gt;, tspan[^&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; .. ^&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;@[0.0, 0.05, 0.1] . . . @[4.9, 4.95, 5.0]
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;@[0.0, 0.05, 0.1] . . . @[4.9, 4.95, 5.0]&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;We compute the solution according to our selected 2 methods and 3 timesteps:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt;
   options1 = newODEoptions(dt = &lt;span class=&quot;hljs-number&quot;&gt;0.1&lt;/span&gt;)
@@ -131,16 +129,14 @@ RK4:
 -1.6124233
 -1.6123745
 Analytical:
--1.6123744
-&lt;/samp&gt;&lt;/pre&gt;
+-1.6123744&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;As expected Heun is not very accurate even with smaller timesteps, while Runge-Kutta is very reliable even with bigger timesteps.&lt;/p&gt;
 &lt;p&gt;To compute percentage error of each method at $y(5)$ I will use:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;proc&lt;/span&gt; pe(yApprox: &lt;span class=&quot;hljs-built_in&quot;&gt;float&lt;/span&gt;): &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; =
   &lt;span class=&quot;hljs-string&quot;&gt;fmt&amp;quot;{(100.0*abs(yApprox - y5) / abs(y5)):.3f}%&amp;quot;&lt;/span&gt;
 
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; pe y1hn[^&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]             &lt;span class=&quot;hljs-comment&quot;&gt;## used like this&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;30.083%
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;30.083%&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;The following table is built as a Markdown table in a &lt;code&gt;nbText&lt;/code&gt; block.&lt;/p&gt;
 &lt;p&gt;&lt;strong&gt;Table 1.&lt;/strong&gt; Percentage errors&lt;/p&gt;
 &lt;table&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/numerical.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;penguins.html&quot;&gt;penguins.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/penguins.html b/C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html
index 942d6eb..eb80fd7 100644
--- a/C:/Users/ppeterlongo/nimib/docs/penguins.html
+++ b/C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html
@@ -73,9 +73,7 @@ with &lt;a href=&quot;https://github.com/Vindaar/ggplotnim&quot;&gt;ggplotnim&lt;/a&gt;&lt;/p&gt;
                    16               Adelie            Torgersen                 38.7                   19                  195                 3450               FEMALE
                    17               Adelie            Torgersen                 42.5                 20.7                  197                 4500                 MALE
                    18               Adelie            Torgersen                 34.4                 18.4                  184                 3325               FEMALE
-                   19               Adelie            Torgersen                   46                 21.5                  194                 4200                 MALE
-
-&lt;/samp&gt;&lt;/pre&gt;
+                   19               Adelie            Torgersen                   46                 21.5                  194                 4200                 MALE&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;Note that among the 7 columns of the dataframe, the first 2 and the last one have datatype string.
 The remaining 4 are numeric but they have datatype object. Why?&lt;/p&gt;
 &lt;p&gt;Because that there are null values in those columns (interpreted as strings):&lt;/p&gt;
@@ -88,13 +86,11 @@ The remaining 4 are numeric but they have datatype object. Why?&lt;/p&gt;
 VFloat
 VString
 VInt
-VString
-&lt;/samp&gt;&lt;/pre&gt;
+VString&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;Let's see how many penguins by species we have (and how do they relate to islands).&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df, aes(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;, fill = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;island&amp;quot;&lt;/span&gt;)) + geom_bar() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_count_species.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_count_species.png&quot; alt=&quot;Count of penguins by species&quot;&gt;
 &lt;figcaption&gt;Count of penguins by species&lt;/figcaption&gt;
@@ -120,8 +116,7 @@ from where this dataset comes from:&lt;/p&gt;
 ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;flipper_length_mm&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;sex&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_mass_vs_length_with_sex.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_mass_vs_length_with_sex.png&quot; alt=&quot;Penguins' mass vs flipper length (colored by sex)&quot;&gt;
 &lt;figcaption&gt;Penguins' mass vs flipper length (colored by sex)&lt;/figcaption&gt;
@@ -137,8 +132,7 @@ ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;flipper_length_mm&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_mass_vs_length_with_species.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_mass_vs_length_with_species.png&quot; alt=&quot;Penguins' mass vs flipper length (colored by species)&quot;&gt;
 &lt;figcaption&gt;Penguins' mass vs flipper length (colored by species)&lt;/figcaption&gt;
@@ -150,8 +144,7 @@ as reported by &lt;a href=&quot;https://twitter.com/andrewheiss/status/13011667926274211
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;culmen_depth_mm&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_simpson.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_simpson.png&quot; alt=&quot;Simpson's paradox in Penguins' dataset: for every species bigger mass is correlated with thicker bill,
 but looking at all species taken together bigger mass is correlated with thinner bill&quot;&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/penguins.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;pythno.html&quot;&gt;pythno.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/pythno.html b/C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html
index b05e166..a4c38f7 100644
--- a/C:/Users/ppeterlongo/nimib/docs/pythno.html
+++ b/C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html
@@ -52,8 +52,7 @@ to modify code and output of a block after it has run.&lt;/p&gt;
   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;result&lt;/span&gt;
   
 print(repeat(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;_this_is_not_python&amp;quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;))&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python&lt;/samp&gt;&lt;/pre&gt;
 
 &lt;/main&gt;
 &lt;footer&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/pythno.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;far\from\home.html&quot;&gt;far\from\home.nim&lt;/a&gt;
</samp></pre>
<hr />
<h1>Implementation</h1>
<p>The following is an adaption of <a href="https://github.com/treeform/ptest/blob/master/src/ptest.nim">treeform's ptest.nim</a>
taking into account specifics of nimib files: they already produce an output (html file).</p>
<p>Imports and global variables:</p>
<pre><code class="nim hljs"><span class="hljs-keyword">var</span>
  test: <span class="hljs-type">TestCase</span>
  tests: <span class="hljs-built_in">seq</span>[<span class="hljs-type">TestCase</span>]</code></pre>
<h3>test cases</h3>
<p>for every file ending in nim (and not starting with ptest) in nbHomeDir (test cases)</p>
<ul>
<li>a test case will be skipped if it is not tracked in git</li>
<li>a test case will be skipped if it does not have a corresponding html</li>
<li>a test case will be skipped if it is modified/added in git</li>
</ul>
<pre><code class="nim hljs"><span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> walkDirRec(nbHomeDir):
  <span class="hljs-comment">## note that file is an AbsoluteFile (since nbHomeDir is an AbsoluteDir)</span>
  <span class="hljs-keyword">if</span> file.endsWith(<span class="hljs-string">&quot;.nim&quot;</span>) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> file.name.startsWith(<span class="hljs-string">&quot;ptest&quot;</span>):
    test = <span class="hljs-type">TestCase</span>(file: file)
    <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;added test candidate: &quot;</span>, file.relPath
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">continue</span>
  <span class="hljs-keyword">let</span> html = changeFileExt(file, <span class="hljs-string">&quot;.html&quot;</span>)
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file.isGitTracked:
    test.skip = <span class="hljs-literal">true</span>
    test.skipReason = srNotTrackedInGit
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it is not tracked in git&quot;</span>
  <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> html.fileExists <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> html.isGitTracked:
    test.skip = <span class="hljs-literal">true</span>
    test.skipReason = srNoHtmlFound
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it does not have a corresponding (git tracked) html file&quot;</span>
  <span class="hljs-keyword">elif</span> file.isGitChanged:
    test.skip = <span class="hljs-literal">true</span>
    test.skipReason = srChangedInGit
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it is changed in git&quot;</span>
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>
  tests.add test</code></pre>
<pre><samp>added test candidate: cheatsheet.nim
added test candidate: hello.nim
added test candidate: index.nim
added test candidate: mostaccio.nim
added test candidate: nolan.nim
added test candidate: numerical.nim
added test candidate: penguins.nim
added test candidate: pythno.nim
added test candidate: far\from\home.nim
</samp></pre>
<h3>performing test</h3>
<p>for every non-skipped test case:</p>
<ul>
<li>if the corresponding html output is changed in git the test is failed</li>
<li>copy the corresponding html to a tmp file</li>
<li>find and execute the corresponding nim file</li>
<li>if an error is found while compiling/executing, report a failure</li>
<li>if a difference is reported between the corresponding html file and the temporary copy a failure is reported</li>
<li>if no failure has been reported the test is reported as passed (and the temporary file is cleaned up)</li>
</ul>
<pre><code class="nim hljs"><span class="hljs-keyword">for</span> test <span class="hljs-keyword">in</span> tests:
  <span class="hljs-keyword">var</span>
    output: <span class="hljs-built_in">string</span>
    err: <span class="hljs-built_in">int</span>
  <span class="hljs-keyword">let</span>
    html = test.file.changeFileExt(<span class="hljs-string">&quot;.html&quot;</span>)
    tmp = test.file.changeFileExt(<span class="hljs-string">&quot;.tmp.html&quot;</span>)
    fileWithLink = test.file.relPath.aLink html.relPath
  <span class="hljs-keyword">if</span> test.skip:
    <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[SKIP]&quot;</span>.spanColor <span class="hljs-string">&quot;blue&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
    <span class="hljs-keyword">continue</span>
  <span class="hljs-keyword">if</span> html.isGitChanged:
    test.fail = <span class="hljs-literal">true</span>
    <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;html file is changed in git. commit or revert and rerun test&quot;</span>
    <span class="hljs-keyword">continue</span>
  copyFile(source = html, dest = tmp)
  (output, err) = execCmdEx &amp;<span class="hljs-string">&quot;nim --verbosity:0 --hints:off r {test.file}&quot;</span>
  <span class="hljs-keyword">if</span> err != <span class="hljs-number">0</span>:
    test.fail = <span class="hljs-literal">true</span>
    <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error during compile/run&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;output</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, output
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;err</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, err
    <span class="hljs-keyword">continue</span>
  (output, err) = execCmdEx(&amp;<span class="hljs-string">&quot;git diff --no-index {html} {tmp}&quot;</span>)
  <span class="hljs-keyword">if</span> err != <span class="hljs-number">0</span>:
    test.fail = <span class="hljs-literal">true</span>
    <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Differences found in html file&quot;</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;output</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, output
    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;err</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, err
    <span class="hljs-keyword">continue</span>
  <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[OK]&quot;</span>.spanColor <span class="hljs-string">&quot;green&quot;</span>
  <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;   &quot;</span> &amp; fileWithLink
  removeFile(tmp)</code></pre>
<pre><samp>&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;cheatsheet.html&quot;&gt;cheatsheet.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;hello.html&quot;&gt;hello.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/hello.html b/C:/Users/ppeterlongo/nimib/docs/hello.tmp.html
index 07d2606..482a6df 100644
--- a/C:/Users/ppeterlongo/nimib/docs/hello.html
+++ b/C:/Users/ppeterlongo/nimib/docs/hello.tmp.html
@@ -45,8 +45,7 @@ and incidentally you might learn the basics of &lt;a href=&quot;https://github.com/pietr
 &lt;h3&gt;A secret message&lt;/h3&gt;
 &lt;p&gt;Inside this document is hidden a secret message. I will ask the computer to spit it out:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; secret&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;[104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;[104, 101, 108, 108, 111, 44, 32, 119, 111, 114, 108, 100]&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;what does this integer sequence mean?
 Am I supposed to &lt;a href=&quot;https://oeis.org/search?q=104%2C+101%2C+108%2C+108%2C+111%2C+44%2C+32%2C+119%2C+111%2C+114%2C+108%2C+100&amp;language=english&amp;go=Search&quot;&gt;recognize it&lt;/a&gt;?&lt;/p&gt;
 &lt;h3&gt;A cryptoanalytic weapon&lt;/h3&gt;
@@ -61,8 +60,7 @@ a recently declassified top-secret cryptoanalytic weapon:&lt;/p&gt;
 finally decrypt what the computer wants to tell me:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; msg = decode secret
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; msg&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;hello, world
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;hello, world&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;&lt;em&gt;Hey&lt;/em&gt;, there must be a bug somewhere, the message (&lt;code&gt;hello, world&lt;/code&gt;) is not even addressed to me!&lt;/p&gt;
 
 &lt;/main&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/hello.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/hello.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;index.html&quot;&gt;index.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;mostaccio.html&quot;&gt;mostaccio.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/mostaccio.html b/C:/Users/ppeterlongo/nimib/docs/mostaccio.tmp.html
index ac7f4bd..1563169 100644
--- a/C:/Users/ppeterlongo/nimib/docs/mostaccio.html
+++ b/C:/Users/ppeterlongo/nimib/docs/mostaccio.tmp.html
@@ -72,9 +72,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;in_california&amp;quot;&lt;/span&gt;] = &lt;span clas
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;Hello Chris
 You have just won 10000 dollars!
-Well, 6000.0 dollars, after taxes.
-
-&lt;/samp&gt;&lt;/pre&gt;
+Well, 6000.0 dollars, after taxes.&lt;/samp&gt;&lt;/pre&gt;
 &lt;h2&gt;DESCRIPTION&lt;/h2&gt;
 &lt;p&gt;Mustache can be used for HTML, config files, source code - anything.
 It works by expanding tags in a template using values provided in a context
@@ -119,8 +117,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;company&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hlj
 * 
 * &amp;amp;lt;b&amp;amp;gt;Github&amp;amp;lt;/b&amp;amp;gt;
 * &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;
-* &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+* &amp;lt;b&amp;gt;Github&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;added the &lt;code&gt;{{&amp;amp;company}}&lt;/code&gt; to clarify that it is just an alternative syntax with the same result
 as the triple mustache.&lt;/p&gt;
@@ -142,9 +139,7 @@ That is, &lt;code&gt;{{#person}}&lt;/code&gt; begins a &amp;quot;person&amp;quot; section while &lt;cod
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;person&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;Shown.
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;Shown.&lt;/samp&gt;&lt;/pre&gt;
 &lt;h4&gt;Non-Empty Lists&lt;/h4&gt;
 &lt;p&gt;If the &lt;strong&gt;person&lt;/strong&gt; key exists and has a non-false value,
 the HTML between the pound and slash will be rendered and displayed one or more times.&lt;/p&gt;
@@ -162,11 +157,9 @@ context = newContext()
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;repo&amp;quot;&lt;/span&gt;] = %*[{&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;resque&amp;quot;&lt;/span&gt;}, {&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;hub&amp;quot;&lt;/span&gt;}, {&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;rip&amp;quot;&lt;/span&gt;}]&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  &amp;lt;b&amp;gt;resque&amp;lt;/b&amp;gt;
+&lt;pre&gt;&lt;samp&gt;&amp;lt;b&amp;gt;resque&amp;lt;/b&amp;gt;
   &amp;lt;b&amp;gt;hub&amp;lt;/b&amp;gt;
-  &amp;lt;b&amp;gt;rip&amp;lt;/b&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;b&amp;gt;rip&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;output is not the expected output:&lt;/p&gt;
 &lt;/blockquote&gt;
@@ -190,8 +183,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;wrapped&amp;quot;&lt;/span&gt;] = &lt;span class=&quot;hlj
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;&amp;lt;b&amp;gt;  Willy is awesome.
-&amp;lt;/b&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+&amp;lt;/b&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;blockquote&gt;
 &lt;p&gt;output is not the expected output:&lt;/p&gt;
 &lt;/blockquote&gt;
@@ -209,9 +201,7 @@ it will be used as the context for a single rendering of the block.&lt;/p&gt;
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;person?&amp;quot;&lt;/span&gt;] = %*{&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;Jon&amp;quot;&lt;/span&gt;}&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  Hi Jon!
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;Hi Jon!&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Inverted Sections&lt;/h3&gt;
 &lt;p&gt;An inverted section begins with a caret (hat) and ends with a slash.
 That is &lt;code&gt;{{^person}}&lt;/code&gt; begins a &amp;quot;person&amp;quot; inverted section while &lt;code&gt;{{/person}}&lt;/code&gt; ends it.&lt;/p&gt;
@@ -231,16 +221,13 @@ That is, they will be rendered if the key doesn't exist, is false, or is an empt
 context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;repo&amp;quot;&lt;/span&gt;] = empty&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Output:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;  No repos :(
-
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;No repos :(&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Comments&lt;/h3&gt;
 &lt;p&gt;Comments begin with a bang and are ignored. The following template:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;tmpl = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&amp;lt;h1&amp;gt;Today{{! ignore me }}.&amp;lt;/h1&amp;gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
 &lt;p&gt;Will render as follows:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(newContext())&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;&amp;lt;h1&amp;gt;Today.&amp;lt;/h1&amp;gt;
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;&amp;lt;h1&amp;gt;Today.&amp;lt;/h1&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Partials&lt;/h3&gt;
 &lt;p&gt;Partials begin with a greater than sign, like &lt;code&gt;{{&amp;gt; box}}&lt;/code&gt;.&lt;/p&gt;
 &lt;p&gt;Partials are rendered at runtime (as opposed to compile time),
@@ -288,16 +275,12 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;names&amp;quot;&lt;/span&gt;] = %*[{&lt;span class=&quot;h
 &lt;pre&gt;&lt;samp&gt;&amp;lt;h2&amp;gt;Names&amp;lt;/h2&amp;gt;
   &amp;lt;strong&amp;gt;resque&amp;lt;/strong&amp;gt;
   &amp;lt;strong&amp;gt;hub&amp;lt;/strong&amp;gt;
-  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;{{&amp;gt;expanded}}&amp;quot;&lt;/span&gt;.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;&amp;lt;h2&amp;gt;Names&amp;lt;/h2&amp;gt;
   &amp;lt;strong&amp;gt;resque&amp;lt;/strong&amp;gt;
   &amp;lt;strong&amp;gt;hub&amp;lt;/strong&amp;gt;
-  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;
-
-&lt;/samp&gt;&lt;/pre&gt;
+  &amp;lt;strong&amp;gt;rip&amp;lt;/strong&amp;gt;&lt;/samp&gt;&lt;/pre&gt;
 &lt;h3&gt;Set Delimiter&lt;/h3&gt;
 &lt;p&gt;Set Delimiter tags start with an equal sign and change the tag delimiters from {{ and }} to custom strings.&lt;/p&gt;
 &lt;p&gt;Consider the following contrived example:&lt;/p&gt;
@@ -321,9 +304,7 @@ context[&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;default_tags_again&amp;quot;&lt;/span&gt;] = &lt;span
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tmpl.render(context)&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;* one
 * two
-* three
-
-&lt;/samp&gt;&lt;/pre&gt;
+* three&lt;/samp&gt;&lt;/pre&gt;
 
 &lt;/main&gt;
 &lt;footer&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/mostaccio.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;nolan.html&quot;&gt;nolan.nim&lt;/a&gt;
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;numerical.html&quot;&gt;numerical.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/numerical.html b/C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html
index 861584f..76e5950 100644
--- a/C:/Users/ppeterlongo/nimib/docs/numerical.html
+++ b/C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html
@@ -85,13 +85,11 @@ to integrate an ODE.&lt;/p&gt;
 &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; y5 = y(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;)
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;y(5): &amp;quot;&lt;/span&gt;, y5&lt;/code&gt;&lt;/pre&gt;
 &lt;pre&gt;&lt;samp&gt;y'(0): 5.0
-y(5): -1.612374396254655
-&lt;/samp&gt;&lt;/pre&gt;
+y(5): -1.612374396254655&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;We want the solution to be available for every point in $[0, 5]$ with timestep $h=0.05$&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; tspan = arange(&lt;span class=&quot;hljs-number&quot;&gt;0.0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;5.0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0.05&lt;/span&gt;, includeEnd = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;)
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; tspan[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; .. &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;], &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot; . . . &amp;quot;&lt;/span&gt;, tspan[^&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; .. ^&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;@[0.0, 0.05, 0.1] . . . @[4.9, 4.95, 5.0]
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;@[0.0, 0.05, 0.1] . . . @[4.9, 4.95, 5.0]&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;We compute the solution according to our selected 2 methods and 3 timesteps:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt;
   options1 = newODEoptions(dt = &lt;span class=&quot;hljs-number&quot;&gt;0.1&lt;/span&gt;)
@@ -131,16 +129,14 @@ RK4:
 -1.6124233
 -1.6123745
 Analytical:
--1.6123744
-&lt;/samp&gt;&lt;/pre&gt;
+-1.6123744&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;As expected Heun is not very accurate even with smaller timesteps, while Runge-Kutta is very reliable even with bigger timesteps.&lt;/p&gt;
 &lt;p&gt;To compute percentage error of each method at $y(5)$ I will use:&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;proc&lt;/span&gt; pe(yApprox: &lt;span class=&quot;hljs-built_in&quot;&gt;float&lt;/span&gt;): &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; =
   &lt;span class=&quot;hljs-string&quot;&gt;fmt&amp;quot;{(100.0*abs(yApprox - y5) / abs(y5)):.3f}%&amp;quot;&lt;/span&gt;
 
 &lt;span class=&quot;hljs-keyword&quot;&gt;echo&lt;/span&gt; pe y1hn[^&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]             &lt;span class=&quot;hljs-comment&quot;&gt;## used like this&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;30.083%
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;30.083%&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;The following table is built as a Markdown table in a &lt;code&gt;nbText&lt;/code&gt; block.&lt;/p&gt;
 &lt;p&gt;&lt;strong&gt;Table 1.&lt;/strong&gt; Percentage errors&lt;/p&gt;
 &lt;table&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/numerical.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/numerical.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;penguins.html&quot;&gt;penguins.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/penguins.html b/C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html
index 942d6eb..eb80fd7 100644
--- a/C:/Users/ppeterlongo/nimib/docs/penguins.html
+++ b/C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html
@@ -73,9 +73,7 @@ with &lt;a href=&quot;https://github.com/Vindaar/ggplotnim&quot;&gt;ggplotnim&lt;/a&gt;&lt;/p&gt;
                    16               Adelie            Torgersen                 38.7                   19                  195                 3450               FEMALE
                    17               Adelie            Torgersen                 42.5                 20.7                  197                 4500                 MALE
                    18               Adelie            Torgersen                 34.4                 18.4                  184                 3325               FEMALE
-                   19               Adelie            Torgersen                   46                 21.5                  194                 4200                 MALE
-
-&lt;/samp&gt;&lt;/pre&gt;
+                   19               Adelie            Torgersen                   46                 21.5                  194                 4200                 MALE&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;Note that among the 7 columns of the dataframe, the first 2 and the last one have datatype string.
 The remaining 4 are numeric but they have datatype object. Why?&lt;/p&gt;
 &lt;p&gt;Because that there are null values in those columns (interpreted as strings):&lt;/p&gt;
@@ -88,13 +86,11 @@ The remaining 4 are numeric but they have datatype object. Why?&lt;/p&gt;
 VFloat
 VString
 VInt
-VString
-&lt;/samp&gt;&lt;/pre&gt;
+VString&lt;/samp&gt;&lt;/pre&gt;
 &lt;p&gt;Let's see how many penguins by species we have (and how do they relate to islands).&lt;/p&gt;
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df, aes(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;, fill = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;island&amp;quot;&lt;/span&gt;)) + geom_bar() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_count_species.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_count_species.png&quot; alt=&quot;Count of penguins by species&quot;&gt;
 &lt;figcaption&gt;Count of penguins by species&lt;/figcaption&gt;
@@ -120,8 +116,7 @@ from where this dataset comes from:&lt;/p&gt;
 ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;flipper_length_mm&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;sex&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_mass_vs_length_with_sex.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_mass_vs_length_with_sex.png&quot; alt=&quot;Penguins' mass vs flipper length (colored by sex)&quot;&gt;
 &lt;figcaption&gt;Penguins' mass vs flipper length (colored by sex)&lt;/figcaption&gt;
@@ -137,8 +132,7 @@ ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;flipper_length_mm&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_mass_vs_length_with_species.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_mass_vs_length_with_species.png&quot; alt=&quot;Penguins' mass vs flipper length (colored by species)&quot;&gt;
 &lt;figcaption&gt;Penguins' mass vs flipper length (colored by species)&lt;/figcaption&gt;
@@ -150,8 +144,7 @@ as reported by &lt;a href=&quot;https://twitter.com/andrewheiss/status/13011667926274211
 &lt;pre&gt;&lt;code class=&quot;nim hljs&quot;&gt;ggplot(df1, aes(x = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;culmen_depth_mm&amp;quot;&lt;/span&gt;, y = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;body_mass_g&amp;quot;&lt;/span&gt;, color = &lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;species&amp;quot;&lt;/span&gt;)) +
     geom_point() +
     ggsave(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;images/penguins_simpson.png&amp;quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;StatusSuccess output of write_to_png&lt;/samp&gt;&lt;/pre&gt;
 &lt;figure&gt;
 &lt;img src=&quot;images/penguins_simpson.png&quot; alt=&quot;Simpson's paradox in Penguins' dataset: for every species bigger mass is correlated with thicker bill,
 but looking at all species taken together bigger mass is correlated with thinner bill&quot;&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/penguins.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/penguins.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:red&quot;&gt;[FAIL]&lt;/span&gt; &lt;a href=&quot;pythno.html&quot;&gt;pythno.nim&lt;/a&gt;
Differences found in html file
output
:diff --git a/C:/Users/ppeterlongo/nimib/docs/pythno.html b/C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html
index b05e166..a4c38f7 100644
--- a/C:/Users/ppeterlongo/nimib/docs/pythno.html
+++ b/C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html
@@ -52,8 +52,7 @@ to modify code and output of a block after it has run.&lt;/p&gt;
   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;result&lt;/span&gt;
   
 print(repeat(&lt;span class=&quot;hljs-string&quot;&gt;&amp;quot;_this_is_not_python&amp;quot;&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;))&lt;/code&gt;&lt;/pre&gt;
-&lt;pre&gt;&lt;samp&gt;_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python
-&lt;/samp&gt;&lt;/pre&gt;
+&lt;pre&gt;&lt;samp&gt;_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python_this_is_not_python&lt;/samp&gt;&lt;/pre&gt;
 
 &lt;/main&gt;
 &lt;footer&gt;
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/pythno.html.
The file will have its original line endings in your working directory
warning: LF will be replaced by CRLF in C:/Users/ppeterlongo/nimib/docs/pythno.tmp.html.
The file will have its original line endings in your working directory

err
:1
&lt;span style=&quot;color:green&quot;&gt;[OK]&lt;/span&gt;   &lt;a href=&quot;far\from\home.html&quot;&gt;far\from\home.nim&lt;/a&gt;
</samp></pre>
<p>results are appended to previously save resultsBlock</p>
<pre><code class="nim hljs"><span class="hljs-keyword">let</span> (skip, fail, pass) = tests.stats
<span class="hljs-keyword">if</span> fail &gt; <span class="hljs-number">0</span>:
  resultsBlock.output.add <span class="hljs-string">&quot; ‚ùå&quot;</span>
<span class="hljs-keyword">else</span>:
  resultsBlock.output.add <span class="hljs-string">&quot; ‚úÖ&quot;</span>
<span class="hljs-keyword">let</span>
  skipHeader = <span class="hljs-string">&quot;skip&quot;</span>.spanColor <span class="hljs-string">&quot;blue&quot;</span>
  failHeader = <span class="hljs-string">&quot;fail&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
  passHeader = <span class="hljs-string">&quot;pass&quot;</span>.spanColor <span class="hljs-string">&quot;green&quot;</span>
resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|{skipHeader}|{failHeader}|{passHeader}|total|&quot;</span>
resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|---|---|---|---|&quot;</span>
resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|{skip}|{fail}|{pass}|{skip + fail + pass}|&quot;</span>
resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-meta">\n</span><span class="hljs-string">{details.renderHtmlCodeOutput}&quot;</span></code></pre>

</main>
<footer>
<hr>
<div class="nb-box">
  <span><span class="nb-small">made with <a href="https://pietroppeter.github.io/nimib/">nimib üê≥</a></span></span>
  <span></span>
  <span><button class="nb-small" id="show" onclick="toggleSourceDisplay()">Show Source</button></span>
</div>
</footer>
<section id="source">
<pre><code class="nim hljs"><span class="hljs-keyword">import</span> os, osproc, strformat, strutils, nimib / paths

<span class="hljs-keyword">proc</span> isGitTracked*(file: <span class="hljs-type">AbsoluteFile</span>): <span class="hljs-built_in">bool</span> =
  <span class="hljs-comment"># https://stackoverflow.com/questions/2405305/how-to-tell-if-a-file-is-git-tracked-by-shell-exit-code</span>
  <span class="hljs-keyword">let</span> (_, err) = execCmdEx(<span class="hljs-string">&quot;git ls-files --error-unmatch &quot;</span> &amp; file.<span class="hljs-built_in">string</span>)
  err == <span class="hljs-number">0</span>

<span class="hljs-keyword">proc</span> gitChangedFiles* : <span class="hljs-built_in">seq</span>[<span class="hljs-type">AbsoluteFile</span>] =
  <span class="hljs-keyword">let</span>
    (output, err) = execCmdEx(<span class="hljs-string">&quot;git status -s&quot;</span>)
    dir = getCurrentDir()
  <span class="hljs-keyword">if</span> err &gt; <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span>
  <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> output.splitlines:
    <span class="hljs-keyword">if</span> line.len &lt; <span class="hljs-number">4</span>:
      <span class="hljs-keyword">continue</span>
    <span class="hljs-literal">result</span>.add (dir / line[<span class="hljs-number">3.</span>.^<span class="hljs-number">1</span>]).<span class="hljs-type">AbsoluteFile</span>

<span class="hljs-keyword">proc</span> isGitChanged*(file: <span class="hljs-type">AbsoluteFile</span>): <span class="hljs-built_in">bool</span> =
  <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> gitChangedFiles():
    <span class="hljs-keyword">if</span> f == file: <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>

<span class="hljs-keyword">type</span>
  <span class="hljs-type">SkipReason</span>* = <span class="hljs-keyword">enum</span>
    srNotSkipped, srNotTrackedInGit, srNoHtmlFound, srChangedInGit
  <span class="hljs-type">TestCase</span>* = <span class="hljs-keyword">ref</span> <span class="hljs-keyword">object</span>  <span class="hljs-comment">## ref to make it easy to mutate while in a container</span>
    file*: <span class="hljs-type">AbsoluteFile</span>
    skip*: <span class="hljs-built_in">bool</span>
    skipReason*: <span class="hljs-type">SkipReason</span>
    fail*: <span class="hljs-built_in">bool</span>

<span class="hljs-keyword">func</span> find*(s: <span class="hljs-built_in">seq</span>[<span class="hljs-type">TestCase</span>], file: <span class="hljs-type">AbsoluteFile</span>, test: <span class="hljs-keyword">var</span> <span class="hljs-type">TestCase</span>): <span class="hljs-built_in">bool</span> =
  <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> s:
    <span class="hljs-keyword">if</span> t.file == file:
      test = t
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>

<span class="hljs-keyword">func</span> spanColor*(text, color: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;&lt;span style=</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">color:&quot;</span> &amp; color &amp; <span class="hljs-string">&quot;</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">&gt;&quot;</span> &amp; text &amp; <span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>
<span class="hljs-keyword">func</span> aLink*(text, link: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">string</span> = <span class="hljs-string">&quot;&lt;a href=</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">&quot;</span> &amp; link &amp; <span class="hljs-string">&quot;</span><span class="hljs-meta">\&quot;</span><span class="hljs-string">&gt;&quot;</span> &amp; text &amp; <span class="hljs-string">&quot;&lt;/a&gt;&quot;</span>

<span class="hljs-keyword">func</span> stats*(tests: <span class="hljs-built_in">seq</span>[<span class="hljs-type">TestCase</span>]): <span class="hljs-keyword">tuple</span>[skip, fail, pass: <span class="hljs-built_in">int</span>] =
  <span class="hljs-keyword">for</span> test <span class="hljs-keyword">in</span> tests:
    <span class="hljs-keyword">if</span> test.skip:
      inc <span class="hljs-literal">result</span>.skip
      <span class="hljs-keyword">continue</span>
    <span class="hljs-keyword">elif</span> test.fail:
      inc <span class="hljs-literal">result</span>.fail
    <span class="hljs-keyword">else</span>:
      inc <span class="hljs-literal">result</span>.pass

<span class="hljs-keyword">when</span> isMainModule:
  <span class="hljs-keyword">import</span> nimib
  nbInit <span class="hljs-comment"># this will also put me in docs folder</span>

  nbText: <span class="hljs-string">&quot;&quot;&quot;# Print-testing for nimib

What is print-testing? Testing by comparing printed output of a file with a versioned reference (see [treeform/ptest](https://github.com/treeform/ptest)). 
&quot;&quot;&quot;</span>
  nbText: <span class="hljs-string">&quot;&quot;&quot;## Test Results&quot;&quot;&quot;</span>
  <span class="hljs-keyword">var</span> resultsBlock = nbBlock  <span class="hljs-comment"># I will add to it at the end</span>

  nbText: <span class="hljs-string">&quot;&quot;&quot;---
# Implementation

The following is an adaption of [treeform's ptest.nim](https://github.com/treeform/ptest/blob/master/src/ptest.nim)
taking into account specifics of nimib files: they already produce an output (html file).

Imports and global variables:
&quot;&quot;&quot;</span>
  nbCode:
    <span class="hljs-keyword">var</span>
      test: <span class="hljs-type">TestCase</span>
      tests: <span class="hljs-built_in">seq</span>[<span class="hljs-type">TestCase</span>]

  <span class="hljs-keyword">when</span> <span class="hljs-keyword">defined</span>(nbDebug):
    nbText: <span class="hljs-string">&quot;Current directory as results of calling nbInit:&quot;</span>
    nbCode: <span class="hljs-keyword">echo</span> getCurrentDir()

  nbText: <span class="hljs-string">&quot;&quot;&quot;### test cases
for every file ending in nim (and not starting with ptest) in nbHomeDir (test cases)
  - a test case will be skipped if it is not tracked in git
  - a test case will be skipped if it does not have a corresponding html
  - a test case will be skipped if it is modified/added in git
&quot;&quot;&quot;</span>
  nbCode:
    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> walkDirRec(nbHomeDir):
      <span class="hljs-comment">## note that file is an AbsoluteFile (since nbHomeDir is an AbsoluteDir)</span>
      <span class="hljs-keyword">if</span> file.endsWith(<span class="hljs-string">&quot;.nim&quot;</span>) <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> file.name.startsWith(<span class="hljs-string">&quot;ptest&quot;</span>):
        test = <span class="hljs-type">TestCase</span>(file: file)
        <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;added test candidate: &quot;</span>, file.relPath
      <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">continue</span>
      <span class="hljs-keyword">let</span> html = changeFileExt(file, <span class="hljs-string">&quot;.html&quot;</span>)
      <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> file.isGitTracked:
        test.skip = <span class="hljs-literal">true</span>
        test.skipReason = srNotTrackedInGit
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it is not tracked in git&quot;</span>
      <span class="hljs-keyword">elif</span> <span class="hljs-keyword">not</span> html.fileExists <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> html.isGitTracked:
        test.skip = <span class="hljs-literal">true</span>
        test.skipReason = srNoHtmlFound
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it does not have a corresponding (git tracked) html file&quot;</span>
      <span class="hljs-keyword">elif</span> file.isGitChanged:
        test.skip = <span class="hljs-literal">true</span>
        test.skipReason = srChangedInGit
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; -&gt; skipped since it is changed in git&quot;</span>
      <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>
      tests.add test

    <span class="hljs-comment"># for file in gitChangedFiles():</span>
    <span class="hljs-comment">#   if tests.find(file, test) and not test.skip:</span>
    <span class="hljs-comment">#     test.skip = true</span>
    <span class="hljs-comment">#     test.skipReason = srChangedInGit</span>
    <span class="hljs-comment">#     echo &quot; -&gt; skipped since it is changed in git&quot;, file.relPath</span>

  nbText: <span class="hljs-string">&quot;&quot;&quot;### performing test
for every non-skipped test case:
  - if the corresponding html output is changed in git the test is failed
  - copy the corresponding html to a tmp file
  - find and execute the corresponding nim file
  - if an error is found while compiling/executing, report a failure
  - if a difference is reported between the corresponding html file and the temporary copy a failure is reported
  - if no failure has been reported the test is reported as passed (and the temporary file is cleaned up)
&quot;&quot;&quot;</span>
  nbCode:
    <span class="hljs-keyword">for</span> test <span class="hljs-keyword">in</span> tests:
      <span class="hljs-keyword">var</span>
        output: <span class="hljs-built_in">string</span>
        err: <span class="hljs-built_in">int</span>
      <span class="hljs-keyword">let</span>
        html = test.file.changeFileExt(<span class="hljs-string">&quot;.html&quot;</span>)
        tmp = test.file.changeFileExt(<span class="hljs-string">&quot;.tmp.html&quot;</span>)
        fileWithLink = test.file.relPath.aLink html.relPath
      <span class="hljs-keyword">if</span> test.skip:
        <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[SKIP]&quot;</span>.spanColor <span class="hljs-string">&quot;blue&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
        <span class="hljs-keyword">continue</span>
      <span class="hljs-keyword">if</span> html.isGitChanged:
        test.fail = <span class="hljs-literal">true</span>
        <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;html file is changed in git. commit or revert and rerun test&quot;</span>
        <span class="hljs-keyword">continue</span>
      copyFile(source=html, dest=tmp)
      (output, err) = execCmdEx &amp;<span class="hljs-string">&quot;nim --verbosity:0 --hints:off r {test.file}&quot;</span>
      <span class="hljs-keyword">if</span> err != <span class="hljs-number">0</span>:
        test.fail = <span class="hljs-literal">true</span>
        <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Error during compile/run&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;output</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, output
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;err</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, err
        <span class="hljs-keyword">continue</span>
      (output, err) = execCmdEx(&amp;<span class="hljs-string">&quot;git diff --no-index {html} {tmp}&quot;</span>)
      <span class="hljs-keyword">if</span> err != <span class="hljs-number">0</span>:
        test.fail = <span class="hljs-literal">true</span>
        <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[FAIL]&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot; &quot;</span> &amp; fileWithLink
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Differences found in html file&quot;</span>
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;output</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, output
        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;err</span><span class="hljs-meta">\n</span><span class="hljs-string">:&quot;</span>, err
        <span class="hljs-keyword">continue</span>
      <span class="hljs-literal">stdout</span>.write <span class="hljs-string">&quot;[OK]&quot;</span>.spanColor <span class="hljs-string">&quot;green&quot;</span>
      <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;   &quot;</span> &amp; fileWithLink
      removeFile(tmp)
    
  <span class="hljs-keyword">let</span> details = nbBlock.output

  nbText: <span class="hljs-string">&quot;results are appended to previously save resultsBlock&quot;</span>
  nbCode:
    <span class="hljs-keyword">let</span> (skip, fail, pass) = tests.stats
    <span class="hljs-keyword">if</span> fail &gt; <span class="hljs-number">0</span>:
      resultsBlock.output.add <span class="hljs-string">&quot; ‚ùå&quot;</span> <span class="hljs-comment"># slug for this? now emoji.muan is not helpful anymore...</span>
    <span class="hljs-keyword">else</span>:
      resultsBlock.output.add <span class="hljs-string">&quot; ‚úÖ&quot;</span>
    <span class="hljs-keyword">let</span>
      skipHeader = <span class="hljs-string">&quot;skip&quot;</span>.spanColor <span class="hljs-string">&quot;blue&quot;</span>
      failHeader = <span class="hljs-string">&quot;fail&quot;</span>.spanColor <span class="hljs-string">&quot;red&quot;</span>
      passHeader = <span class="hljs-string">&quot;pass&quot;</span>.spanColor <span class="hljs-string">&quot;green&quot;</span>
    resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|{skipHeader}|{failHeader}|{passHeader}|total|&quot;</span>
    resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|---|---|---|---|&quot;</span>
    resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-string">|{skip}|{fail}|{pass}|{skip + fail + pass}|&quot;</span>
    resultsBlock.output.add &amp;<span class="hljs-string">&quot;</span><span class="hljs-meta">\n</span><span class="hljs-meta">\n</span><span class="hljs-string">{details.renderHtmlCodeOutput}&quot;</span>

  nbSave
  quit(fail)</code></pre>
</section><script>
function toggleSourceDisplay() {
  var btn = document.getElementById("show")
  var source = document.getElementById("source");
  if (btn.innerHTML=="Show Source") {
    btn.innerHTML = "Hide Source";
    source.style.display = "block";
  } else {
    btn.innerHTML = "Show Source";
    source.style.display = "none";
  }
}
</script></body>
</html>