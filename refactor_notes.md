todo:

- [ ] be able to run nim r docs/hello (also with nimibPreviewCodeAsInSource)
  - [x] newNbNewBlock
  - [x] context field for NbBlock (populated during newNbBlock)
  - [x] new nbText and nbCode
  - [ ] renderBlock generic proc
  - [ ] renderPlan(s) and renderProc(s) for NbDoc
  - [x] ~optional renderPlan and partial for NbBlock?~ no need. Change command name and add specific partial and renderPlan in doc.
  - [ ] new nbSave
- [ ] be able to run the rest of documentation
  - [ ] nbImage
  - [ ] nbFile
  - [ ] add also nbAudio, nbVideo? (with new doc examples)
  - [ ] add task nimble docs to build docs
  - [ ] update notebooks to use more recent functionality (e.g. cheatsheet and others...)
- [ ] tests
  - [x] tblocks.newNbBlock
  - [x] tnimib.nbText
  - [x] tnimib.nbCode
- [ ] addons
  - [x] new logging
  - [x] nbNormalize (taken from tsources)
- [ ] cleanup
  - [ ] remove old newBlock
  - [ ] remove manageErrors (never used)
- [ ] check that projects that depend on nimib are not broken
  - [ ] nimibook
  - [ ] scinim/getting-started
  - [ ] nimislides
- [ ] release
  - [ ] bump to 0.3
  - [ ] prepare release notes

notes:

- testing will also be improved (did not notice that ptest is turned off)
- (I could also almost pass to an improved doc generation workflow... - problem with README though...)
- [breaking change] code will be stripped by default (as a sort of normalization)
  - with this change I might able to simplify also tests in tsources? should I normalize in the same way?
- all templates have been moved outside of nbInit (no more unused warning!)
- log will move in newBlock? will it be newBlock(cmd: string, body, blockImpl: untyped) so that I can call a log at the end?
- added render backend as customizable in nbInit
- added a context field to NbBlock (inherits partials from nb object)
- I cannot have the context to inherit also values from nb object (values not exported and there is no derive in nim-mustache for context, I might want to do a PR)
- no need to have a partial field in NbBlock. will render using "{{> " & blk.cmd & "}}" (e.g. {{> nbText}})
- actually a partial field is needed if I want to customize (it could be optional). same for a renderPlan for the block
- but as first iteration (internal to this PR) I could just use the partials and renderPlans in the doc
- later I need to decide if I want them to be Option object (they should be but I never used much that API and not sure if it is worth it) or not
- refactored newBlock to contain blockImpl and other identifiers (nbBlock, nbDoc - will this names clash with aliases?)
  - also renamed to newNbBlock
  - also added simple logging (should I have a whale emoji everywhere instead of \[nimib\]? yeah probably! but maybe I leave it for another PR...)
- not sure whether to use renderPlans or renderPlan for NbDoc (and renderProcs or renderProc?)
- code is now normalized (including newlines)
- minimal testing for nbText and nbCode added (could be improved later)
- note that output currently not stripped and by default it has a newLine at end. should I remove the newline at the end? (we will in rendering...)